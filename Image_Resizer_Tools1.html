<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<title>Image Resizer</title>
<style>
    body {
        font-family: Arial, sans-serif;
        background: linear-gradient(145deg, #0f0f0f, #1a1a1a);
        color: #fff;
        display: flex;
        justify-content: center;
        padding: 20px;
    }
    .container {
        background: #1b1b1b;
        padding: 20px;
        border-radius: 12px;
        width: 100%;
        max-width: 500px;
        box-shadow: 0 0 20px #000;
    }
    h1 { text-align: center; }
    label { margin-top: 10px; display: block; font-weight: bold; }
    input, button {
        width: 100%;
        padding: 10px;
        border-radius: 6px;
        border: none;
        margin-top: 6px;
        font-size: 15px;
    }
    button { cursor: pointer; }
    .quick-sizes button {
        background: #ff5722;
        color: #fff;
        margin: 4px;
        width: 47%;
        font-weight: bold;
    }
    .bg-buttons {
        display: flex;
        gap: 6px;
    }
    .bg-buttons button {
        flex: 1;
        font-weight: bold;
    }
    .bg-buttons .transparent { background: #2196f3; color: #fff; }
    .bg-buttons .pick-colour { background: #555; color: #fff; }
    .color-preview {
        display: flex;
        align-items: center;
        gap: 8px;
        margin-top: 6px;
        font-size: 14px;
    }
    .color-box {
        width: 20px; height: 20px;
        border: 1px solid #999;
        border-radius: 3px;
    }
    .save-format button {
        width: 24%;
        margin: 3px;
        font-weight: bold;
        color: #fff;
    }
    .save-format .png { background: #28a745; }
    .save-format .jpg { background: #ff9800; }
    .save-format .gif { background: #9c27b0; }
    .save-format .original { background: #607d8b; }
    .action-btn { background: #4a90e2; color: #fff; margin-top: 10px; }
    .reset-btn { background: #f44336; color: #fff; margin-top: 6px; }
    .preview img {
        margin-top: 10px;
        max-width: 100%;
        border-radius: 8px;
    }
    .download-btn { background: #28a745; color: #fff; }
    .upload-btn { background: #ff9800; color: #fff; margin-top: 6px; }
</style>
</head>
<body>

<div class="container">
    <h1>üìê Image Resizer</h1>

    <label>Select Image from Device:</label>
    <input type="file" accept="image/*" id="imageFile">

    <label>Or Enter Image URL:</label>
    <input type="text" id="imageURL" placeholder="Paste image URL here">
    <button onclick="loadImageFromURL()">Load</button>

    <label>Width (px):</label>
    <input type="number" id="widthInput">

    <label>Height (px):</label>
    <input type="number" id="heightInput">

    <label><input type="checkbox" id="lockAspect" checked> Lock Aspect Ratio</label>

    <!-- Quick Sizes -->
    <div class="quick-sizes">
        <button onclick="setQuickSize(300,280)">300√ó280px</button>
        <button onclick="setQuickSize(280,400)">280√ó400px</button>
    </div>

    <!-- Background Fill -->
    <label>Background Fill:</label>
    <div class="bg-buttons">
        <button class="transparent" onclick="setBgFill('transparent')">Transparent</button>
        <button class="pick-colour" onclick="setBgFill('color')">Pick a colour</button>
    </div>
    <input type="color" id="bgColorPicker" value="#ffffff" style="display:none;" onchange="updateColorCode()">
    <div class="color-preview" id="colorPreview" style="display:none;">
        <div class="color-box" id="colorBox"></div>
        <span id="colorCode"></span>
    </div>

    <!-- Save Format -->
    <label>Save Format:</label>
    <div class="save-format">
        <button class="png" onclick="setFormat('png')">PNG</button>
        <button class="jpg" onclick="setFormat('jpeg')">JPG</button>
        <button class="gif" onclick="setFormat('gif')">GIF</button>
        <button class="original" onclick="setFormat('original')">Original</button>
    </div>

    <!-- Action Buttons -->
    <button class="action-btn" onclick="resizeImage()">Resize Image</button>
    <button class="reset-btn" onclick="resetPreview()">Reset Preview</button>

    <!-- Preview -->
    <div class="preview">
        <img id="preview" src="https://i.postimg.cc/d1hHy4ss/11.png" alt="Preview">
        <a id="downloadLink" class="download-btn" style="display:none;" download>‚¨á Download Resized Image</a>
        <button id="uploadPostimages" class="upload-btn" style="display:none;">‚òÅ Upload to Postimages</button>
        <input type="text" id="directLinkBox" readonly style="display:none;width:100%;padding:8px;margin-top:5px;border-radius:5px;border:none;" onclick="this.select();document.execCommand('copy');alert('Link copied!')">
    </div>
</div>

<script>
let originalImage = new Image();
let aspectRatio = 1;
let originalFormat = 'image/png';
let bgFill = 'transparent';
let bgColor = '#ffffff';
let saveFormat = 'png';

document.getElementById('imageFile').addEventListener('change', function(e) {
    const file = e.target.files[0];
    if (file) {
        originalFormat = file.type;
        const reader = new FileReader();
        reader.onload = evt => loadImage(evt.target.result);
        reader.readAsDataURL(file);
    }
});

function loadImageFromURL() {
    const url = document.getElementById('imageURL').value;
    loadImage(url);
}

function loadImage(src) {
    originalImage = new Image();
    originalImage.crossOrigin = 'Anonymous';
    originalImage.onload = () => {
        aspectRatio = originalImage.width / originalImage.height;
        document.getElementById('widthInput').value = originalImage.width;
        document.getElementById('heightInput').value = originalImage.height;
        document.getElementById('preview').src = src;
    };
    originalImage.src = src;
}

document.getElementById('widthInput').addEventListener('input', function() {
    if (document.getElementById('lockAspect').checked) {
        document.getElementById('heightInput').value = Math.round(this.value / aspectRatio);
    }
});
document.getElementById('heightInput').addEventListener('input', function() {
    if (document.getElementById('lockAspect').checked) {
        document.getElementById('widthInput').value = Math.round(this.value * aspectRatio);
    }
});

function setQuickSize(w,h) {
    document.getElementById('widthInput').value = w;
    document.getElementById('heightInput').value = h;
}

function setBgFill(type) {
    bgFill = type;
    const picker = document.getElementById('bgColorPicker');
    const preview = document.getElementById('colorPreview');
    if (type === 'color') {
        picker.style.display = 'block';
        preview.style.display = 'flex';
        updateColorCode();
    } else {
        picker.style.display = 'none';
        preview.style.display = 'none';
    }
}

function updateColorCode() {
    bgColor = document.getElementById('bgColorPicker').value;
    document.getElementById('colorBox').style.background = bgColor;
    document.getElementById('colorCode').textContent = bgColor;
}

function setFormat(format) {
    saveFormat = format;
}

function resizeImage() {
    const canvas = document.createElement('canvas');
    const ctx = canvas.getContext('2d');
    const width = parseInt(document.getElementById('widthInput').value);
    const height = parseInt(document.getElementById('heightInput').value);

    canvas.width = width;
    canvas.height = height;

    if (bgFill === 'color') {
        ctx.fillStyle = bgColor;
        ctx.fillRect(0, 0, width, height);
    } else {
        ctx.clearRect(0, 0, width, height);
    }

    ctx.drawImage(originalImage, 0, 0, width, height);

    let mimeType = 'image/png';
    if (saveFormat === 'jpeg') mimeType = 'image/jpeg';
    if (saveFormat === 'gif') mimeType = 'image/gif';
    if (saveFormat === 'original') mimeType = originalFormat;

    const dataURL = canvas.toDataURL(mimeType);
    document.getElementById('preview').src = dataURL;

    const downloadLink = document.getElementById('downloadLink');
    downloadLink.href = dataURL;
    downloadLink.download = `resized.${mimeType.split('/')[1]}`;
    downloadLink.style.display = 'inline-block';

    document.getElementById('uploadPostimages').style.display = 'inline-block';
}

function resetPreview() {
    document.getElementById('preview').src = 'https://i.postimg.cc/d1hHy4ss/11.png';
    document.getElementById('downloadLink').style.display = 'none';
    document.getElementById('uploadPostimages').style.display = 'none';
    document.getElementById('directLinkBox').style.display = 'none';
}

// Postimages Upload
document.getElementById('uploadPostimages').addEventListener('click', function() {
    const img = document.getElementById('preview');
    fetch(img.src)
        .then(res => res.blob())
        .then(blob => {
            const formData = new FormData();
            formData.append('token', '61aa06d6116f7331ad7b2ba9c7fb707ec9b182e8');
            formData.append('upload_session', 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa');
            formData.append('numfiles', '1');
            formData.append('upload_referer', 'https://getsharex.com/');
            formData.append('file', blob, 'image.png');

            return fetch('https://postimg.cc/json', { method: 'POST', body: formData });
        })
        .then(res => res.json())
        .then(result => {
            if (result && result.url) {
                document.getElementById('directLinkBox').value = result.url;
                document.getElementById('directLinkBox').style.display = 'block';
                navigator.clipboard.writeText(result.url);
                alert('Upload successful! Direct link copied.');
                window.open(result.url, "_blank");
            } else {
                alert('Upload failed!');
            }
        })
        .catch(err => {
            console.error(err);
            alert('Error uploading image.');
        });
});
</script>

</body>
</html>
