
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
<!-- gif.js লাইব্রেরি -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/gif.js/0.2.0/gif.js"></script>

<!-- gif.js লাইব্রেরি যোগ করো -->
<script src="https://cdn.jsdelivr.net/npm/gif.js.optimized/dist/gif.min.js"></script>
<title>Image Resizer — Sirome TV</title>
<link rel="icon" href="https://i.postimg.cc/d1hHy4ss/11.png" />
<style>
  :root{
    --bg:#121212;
    --card:#1f1f1f;
    --muted:#bdbdbd;
    --accent:#2196f3;
    --radius:10px;
    --gap:10px;
  }
  html,body{
      height:100%; 
      margin:0; 
      background:#0f0f0f; 
      color:#fff; 
      font-family:Inter, Arial, Helvetica, sans-serif;
      user-select: none;
  }
  .wrap{
      min-height:100vh; 
      display:flex; 
      align-items:center; 
      justify-content:center; 
      padding:24px;
  }
  .card{
    width:420px;
    max-width:96%;
    background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    border-radius:var(--radius);
    padding:18px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.6), inset 0 1px 0 rgba(255,255,255,0.02);
    backdrop-filter: blur(4px);
  }

  h1{
      font-size:25px; 
      margin:0 0 12px; 
      text-align:center; 
      letter-spacing:0.2px
  }
  label.small{
      font-size:15px; 
      color:white; 
      display:block; 
      margin-bottom:6px
      font-weight: bold;
  }

/* ফাইল, টেক্সট এবং নাম্বার ইনপুটের জন্য সাধারণ স্টাইল */
    input[type="file"],
    input[type="text"],
    input[type="number"] {
    width: 100%; /* ইনপুট ফিল্ড সম্পূর্ণ প্রস্থ নেয় */
    padding: 10px 12px;  /* ভেতরের স্পেসিং (উপরে-নিচে 10px, ডানে-বামে 12px) */
    border-radius: 8px;  /* কোণগুলো গোলাকার করার জন্য */
    border: 1px solid #555; /* কোনো বর্ডার থাকবে না */
    background-color: #121212;/* ডার্ক গ্রে/কালো মত ব্যাকগ্রাউন্ড */
    color: #fff;  /* লেখার রং সাদা */
    box-sizing: border-box; /* প্যাডিং ও বর্ডার ইনপুটের আকারে যোগ হবে */
    margin-bottom: 10px; /* নিচে 10px ফাঁকা স্থান */
    font-size: 12px;  /* লেখার সাইজ একটু বড়, পড়তে সহজ */
    transition: background-color 0.3s ease, border-color 0.3s ease; /* হালকা অ্যানিমেশন ইফেক্ট */
}

/* ইনপুট ফোকাস হলে একটু হালকা পরিবর্তন */
    input[type="file"]:focus,
    input[type="text"]:focus,
    input[type="number"]:focus {
        outline: none;   /* ব্রাউজারের ডিফল্ট ফোকাস আউটলাইন বন্ধ */
        background-color: #000;/* একটু হালকা কালো ব্যাকগ্রাউন্ড */
        color: #fff;  /* লেখার রং সাদা থাকবে */
}
  

  /* Top row: Lock toggle + Quick Sizer buttons */
  .row {
      display:flex; gap:var(--gap); 
      align-items:center; 
      margin-bottom:10px;
      
  }
  .col {flex:1}

  /* Toggle switch (custom) */
  .toggle-wrap{
      display:flex; 
      align-items:center; gap:12px
      
  }
  .switch {
    width:44px; 
    height:24px; 
    background:#2b2b2b; 
    border-radius:20px; 
    position:relative; 
    cursor:pointer; 
    transition:0.18s;
    flex-shrink:0;
  }
  .switch.on{ 
      background:#4caf50; 
      box-shadow: 0 4px 12px rgba(76,175,80,0.18);}
      
  .switch .dot{ 
      width:18px; 
      height:18px; 
      background:#fff; 
      border-radius:50%; 
      position:absolute; 
      top:3px; 
      left:3px; 
      transition:0.18s; 
      
  }
  .switch.on .dot{ left:23px; }

  .quick-sizes{
      display:flex; gap:8px; 
      flex-wrap:wrap; 
      width:100%;
      
  }
  .quick-sizes button {
    flex: 1; 
    min-width: 120px; 
    padding: 8px 10px; 
    border-radius: 8px; 
    border: none; 
    cursor: pointer; 
    font-weight: 600;
    color: #111; 
    background: white; 
    box-shadow: 0 6px 16px rgba(255,138,80,0.12);
    transition: background-color 0.1s ease, color 0.3s ease;
}   /* ক্লিক বা active অবস্থায় */
    .quick-sizes button:active {
    background-color: #ffb980;  /* আরেকটু গাঢ় অরেঞ্জ */
    color: #a74100;
    box-shadow: 0 4px 8px rgba(255,138,80,0.3);
}
    /* কার্সার হোভার করলে */
    .quick-sizes button:hover {
    background-color: #ffe6d1;  /* হালকা অরেঞ্জ টোন */
    color: #d45b00;             /* গাঢ় অরেঞ্জ */
}

  /* Background fill buttons */
  .bg-row{
      display:flex; gap:10px; 
      margin-bottom:10px;
      
  }
  .bg-btn{
    flex:1; 
    padding:10px; 
    border-radius:8px; 
    border:2px solid #3e3e3e; 
    font-weight:700; 
    cursor:pointer;
    display:flex; 
    align-items:center; 
    justify-content:center; gap:8px;
  }
  .bg-transparent{ 
      background: linear-gradient(180deg,#3e3e3e,#2d2d2d); 
      color:#fff; 
      box-shadow: inset 0 -2px 0 rgba(0,0,0,0.4);}
      
  .bg-color{ 
      background: linear-gradient(180deg,#ffd8e0,#ff9fb8); 
      color:#111; }

  /* color preview */
  .color-inline{
      display:inline-flex; 
      align-items:center; gap:8px; 
      margin-left:6px;
      
  }
  .color-swatch{ 
      width:50px; 
      height:20px; 
      border-radius:2px; 
      border:2px solid rgba(255,255,255,0.12); 
      display:inline-block; 
      
  }

  /* Format buttons */
  .formats{
      display:flex; gap:8px; 
      flex-wrap:wrap; 
      margin-bottom:10px;
      
  }
  .fmt {
    flex: 1; 
    min-width: 80px; 
    padding: 10px; 
    border-radius: 8px; 
    border: 2.5px solid #3e3e3e; 
    color: #fff; 
    font-weight: 800; 
    cursor: pointer;
    box-shadow: 0 6px 16px rgba(0,0,0,0.25);
    background-color: transparent;
    transition: background-color 0.3s ease, 
    border-color 0.3s ease;
}

    .fmt.active {
        background-color: rgba(255, 255, 255, 0.15);
        border-color: white;
}

  .fmt.png{ background:linear-gradient(180deg,#43a047,#2e7d32);} /* green */
  .fmt.jpg{ background:linear-gradient(180deg,#ffb74d,#fb8c00);} /* orange */
  .fmt.gif{ background:linear-gradient(180deg,#ab47bc,#8e24aa);} /* purple */
  .fmt.webp{ background:linear-gradient(180deg,#4fc3f7,#0288d1);} /* blue */

  /* primary action buttons */
  .actions{
    display:flex; gap:10px; 
    margin-top:6px; 
    flex-direction:column;
      
  }
  .btn-primary{
    padding:12px; 
    border-radius:10px; 
    border:none; 
    font-weight:800; 
    cursor:pointer; 
    color:#fff;
    background:linear-gradient(180deg,var(--accent), #1976d2); 
    box-shadow:0 14px 30px rgba(25,118,210,0.16);
  }
  .btn-reset{ 
      background:linear-gradient(180deg,#e91e63,#d81b60); 
      color:#fff; 
      font-weight:700; 
      border:none; 
      padding:10px; 
      border-radius:8px; 
      cursor:pointer;
      
  }
  .download-upload{
      display:flex; gap:8px; 
      margin-top:10px; 
      align-items:center; 
      justify-content:center; 
      flex-wrap:wrap;
      
  }
  .download-link, .upload-btn{
    padding:10px 12px; 
    border-radius:8px; 
    text-decoration:none; 
    font-weight:800; 
    cursor:pointer; 
    border:none;
  }
  .download-link{ 
      background:linear-gradient(180deg,#43a047,#2e7d32); 
      color:#fff; }
  .upload-btn{ 
      background:linear-gradient(180deg,#ff9800,#fb8c00); 
      color:#111; }

  .preview-area{ 
      margin-top:12px; 
      text-align:center; }
  #preview{ 
      max-width:100%; 
      border-radius:8px; 
      max-height:360px; 
      box-shadow: 0 10px 30px rgba(0,0,0,0.6); 
      background:#000;
      
  }
  #canvas{ display:none; }

  .link-box{ 
      width:100%; 
      padding:10px; 
      border-radius:8px; 
      border:none; 
      margin-top:8px; 
      display:none; 
      background:#111; 
      color:#fff; 
  }

  /* small screens */
  @media (max-width:420px){
    .quick-sizes button{ 
        min-width:100px; 
        font-size:13px; 
        padding:8px;}
    .fmt{ min-width:45%;}
  }
  
  /* small foot */
  .note{ margin-top:8px; color:var(--muted); font-size:0.85rem; text-align:center; }
</style>

<style>
/* Drag & Drop এর জন্য স্টাইল */
.drop-zone {
  border: 2px dashed #555;
  border-radius: 8px;
  padding: 20px;
  text-align: center;
  color: #bbb;
  font-size: 14px;
  margin-bottom: 10px;
  transition: border-color 0.3s ease, background-color 0.3s ease;
}
.drop-zone.dragover {
  border-color: var(--accent);
  background-color: rgba(33,150,243,0.1);
  color: #fff;
}

/* Quick Sizes active highlight */
.quick-sizes button.active {
  background-color: #2196f3 !important;
  color: white !important;
  box-shadow: 0 4px 10px rgba(33,150,243,0.4);
}
</style>

<style>
    #btnPaste {
  background: linear-gradient(180deg,#00c853,#00bfa5); /* Green tone */
  color: #fff;
  font-weight: 700;
  border: none;
  border-radius: 8px;
  cursor: pointer;
}
#btnPaste:active {
  background: #009624;
}


.drop-zone {
    box-shadow: 0 5px 10px rgba(33,150,243,0.4);
    color: #fff;
    font-weight: bold;
  /* ...তোমার আগের স্টাইল থাকবে... */
    cursor: pointer;       /* নতুন */
    outline: none;         /* নতুন */
}
.drop-zone:focus {
  border-color: var(--accent);
  box-shadow: 0 0 0 10px rgba(33,150,243,0.25);
}


</style>
</head>
<body>
  <div class="wrap">
    <div class="card" role="region" aria-label="Image Resizer Tool">
      <h1>📐 Image Resizer Tool</h1>
      
      
<!-- File input + Drag Drop  + URL load -->
<label class="small">Select image (Click or Drag & Drop)</label><br>
<div id="dropZone" class="drop-zone" role="button" tabindex="0" aria-label="Click to select an image or drag & drop here">
  Drag & Drop image here or <u>click</u> to upload
</div>

<!-- Hidden file input: ক্লিক ট্রিগার করার জন্য রাখা হলো -->
<input id="fileInput" type="file" accept="image/*" aria-label="Choose image file" style="display:none;">

      
      

<label class="small">Or Enter Image URL</label>
<div style="margin-bottom:10px;">
  <input id="urlInput" type="text" placeholder="https://example.com/image.jpg" aria-label="Image URL" style="width:100%; margin-bottom:8px;">
  
  <!-- Buttons moved below input -->
  <div style="display:flex; gap:8px; justify-content:center;">
    <button class="download-link" style="padding:8px 10px; flex:1; min-width:72px;" id="btnLoad">Load</button>
    <button class="download-link" style="padding:8px 10px; flex:1; min-width:72px; background:linear-gradient(180deg,#00c853,#00bfa5);" id="btnPaste">Paste</button>
    <button class="btn-reset" style="padding:8px 10px; flex:1; min-width:72px;" id="btnClear">Clear</button>
  </div>
</div>


      <!-- Width / Height -->
      <div class="row" style="margin-bottom:6px;">
        <div class="col">
          <label class="small">Width (px)</label>
          <input id="widthInput" type="number" min="1" inputmode="numeric" placeholder="width">
        </div>
        <div class="col">
          <label class="small">Height (px)</label>
          <input id="heightInput" type="number" min="1" inputmode="numeric" placeholder="height">
        </div>
      </div>

      <!-- Aspect Ratio toggle + Quick sizes -->
      <div class="row" style="margin-bottom:8px;">
        <div style="flex:1">
          <label class="small">Lock Aspect Ratio</label>
          <div class="toggle-wrap" style="justify-content:flex-start;">
            <div id="aspectSwitch" class="switch on" role="switch" aria-checked="true" tabindex="0">
              <div class="dot"></div>
            </div>
            <div style="color:var(--muted); font-size:13px;">(Keep proportions)</div>
          </div>
        </div>
      </div>

      <label class="small">Quick Sizes</label>
      <div class="quick-sizes" style="margin-bottom:8px;">
        <button class="btn-qs" data-w="300" data-h="180">300×180</button>
        <button class="btn-qs" data-w="280" data-h="400">280×400</button>
        
        <button class="btn-qs" data-w="140" data-h="200">140×200</button>
        <button class="btn-qs" data-w="150" data-h="80">150×80</button>
        
        <button class="btn-qs" data-w="70" data-h="50">70×50</button>
        <button class="btn-qs" data-w="1000" data-h="1000">1000×1000</button>
        
        
        
        
      </div>

      <!-- Background Fill -->
      <label class="small">Background Fill</label>
      <div class="bg-row">
        <button id="btnTransparent" class="bg-btn bg-transparent" data-fill="transparent">Transparent</button>
        <button id="btnPickColor" class="bg-btn bg-color" data-fill="color">Pick a colour</button>
      </div>

      <div style="display:flex; gap:8px; align-items:center; margin-bottom:8px;">
        <input id="colorPicker" type="color" value="#ffffff" style="display:none; border-radius:8px; padding:4px;">
        <div id="colorInfo" style="font-size:13px; color:var(--muted); display:none; align-items:center;">
          <span id="colorSwatch" class="color-swatch"></span>
          <span id="colorHex" style="margin-left:8px;">#ffffff</span>
        </div>
      </div>

      <!-- Save Format -->
      <label class="small">Save Format</label>
      <div class="formats">
        <button class="fmt png" data-fmt="png">PNG</button>
        <button class="fmt jpg" data-fmt="jpeg">JPG</button>
        <button class="fmt gif" data-fmt="gif">GIF</button>
        <button class="fmt webp" data-fmt="webp">WEBP</button>
      </div>

      <!-- Actions -->
      <div class="actions">
        <button id="btnResize" class="btn-primary" title="Resize Image">Resize Image</button>
        <button id="btnReset" class="btn-reset" title="Reset Preview">Reset Preview</button>
      </div>

      <!-- Preview / canvas -->
      <div class="preview-area">
        <canvas id="canvas"></canvas>
        <img id="preview" src="https://i.postimg.cc/d1hHy4ss/11.png" alt="Preview image" />
      </div>

      <!-- Download & Upload -->
      <div class="download-upload">
    <a id="downloadLink" class="download-link" style="display:none;" download>📥  Download Resize Image</a>
    <button id="uploadBtn" class="upload-btn" style="display:none;">☁ Upload to Postimages</button>
    <input id="directLink" class="link-box" readonly onclick="this.select();" />
  </div>
  <div class="note">Upload opens postimages link in a new tab & copies the direct link automatically.</div>
  </div>
</div>

<script>
/* -------------------------
   Variables & initial state
   ------------------------- */
const fileInput = document.getElementById('fileInput');
const urlInput = document.getElementById('urlInput');
const btnLoad = document.getElementById('btnLoad');
const widthInput = document.getElementById('widthInput');
const heightInput = document.getElementById('heightInput');
const aspectSwitch = document.getElementById('aspectSwitch');
const qsButtons = document.querySelectorAll('.btn-qs');
const btnTransparent = document.getElementById('btnTransparent');
const btnPickColor = document.getElementById('btnPickColor');
const colorPicker = document.getElementById('colorPicker');
const colorInfo = document.getElementById('colorInfo');
const colorSwatch = document.getElementById('colorSwatch');
const colorHex = document.getElementById('colorHex');
const fmtButtons = document.querySelectorAll('.fmt');
const btnResize = document.getElementById('btnResize');
const btnReset = document.getElementById('btnReset');
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext ? canvas.getContext('2d') : null;
const preview = document.getElementById('preview');
const downloadLink = document.getElementById('downloadLink');
const uploadBtn = document.getElementById('uploadBtn');
const directLink = document.getElementById('directLink');

let originalImage = new Image();
let aspectRatio = 1;
let originalFormat = 'image/png';
let currentBgFill = 'transparent'; // 'transparent' or 'color'
let currentColor = '#ffffff';
let currentFormat = 'png'; // png | jpeg | gif | original
let hasLoadedImage = false;

/* -------------------------
   Helpers
   ------------------------- */
function setActiveFormatButton(fmt){
  fmtButtons.forEach(b=>b.classList.remove('active'));
  const btn = Array.from(fmtButtons).find(b=>b.dataset.fmt === fmt);
  if(btn) btn.classList.add('active');
}

/* Initialize default active format */
setActiveFormatButton('png');

/* -------------------------
   File / URL loading
   ------------------------- */
fileInput.addEventListener('change', e=>{
  const file = e.target.files && e.target.files[0];
  if(!file) return;
  originalFormat = file.type || 'image/png';
  const reader = new FileReader();
  reader.onload = ev=>{
    loadImage(ev.target.result);
  };
  reader.readAsDataURL(file);
});

btnLoad.addEventListener('click', ()=>{
  const url = urlInput.value.trim();
  if(!url) { alert('Please paste an image URL'); return; }
  loadImage(url);
});

function loadImage(src){
  hasLoadedImage = false;
  originalImage = new Image();
  originalImage.crossOrigin = 'anonymous'; // try to avoid tainting canvas
  originalImage.onload = ()=>{
    aspectRatio = originalImage.width / originalImage.height || 1;
    widthInput.value = originalImage.width;
    heightInput.value = originalImage.height;
    preview.src = src;
    hideDownloadUpload();
    hasLoadedImage = true;
  };
  originalImage.onerror = ()=>{
    alert('Unable to load image. Check URL or try uploading file.');
  };
  originalImage.src = src;
}

/* -------------------------
   Width / Height listeners (respect lock)
   ------------------------- */
widthInput.addEventListener('input', function(){
  if(isAspectLocked()){
    const w = parseInt(this.value) || 0;
    const h = Math.max(1, Math.round(w / (aspectRatio || 1)));
    heightInput.value = h;
  }
});
heightInput.addEventListener('input', function(){
  if(isAspectLocked()){
    const h = parseInt(this.value) || 0;
    const w = Math.max(1, Math.round(h * (aspectRatio || 1)));
    widthInput.value = w;
  }
});

/* -------------------------
   Aspect Ratio Toggle
   ------------------------- */
function isAspectLocked(){ return aspectSwitch.classList.contains('on'); }

aspectSwitch.addEventListener('click', ()=>{
  aspectSwitch.classList.toggle('on');
  aspectSwitch.setAttribute('aria-checked', aspectSwitch.classList.contains('on'));
});
aspectSwitch.addEventListener('keydown', (e)=>{
  if(e.key === 'Enter' || e.key === ' ') { e.preventDefault(); aspectSwitch.click(); }
});

/* -------------------------
   Quick size buttons
   ------------------------- */
qsButtons.forEach(btn=>{
  btn.addEventListener('click', ()=>{
    const w = parseInt(btn.dataset.w);
    const h = parseInt(btn.dataset.h);
    widthInput.value = w;
    heightInput.value = h;
  });
});

/* -------------------------
   Background Fill logic
   ------------------------- */
function applyBgSelection(sel){
  currentBgFill = sel;
  if(sel === 'transparent'){
    colorPicker.style.display = 'none';
    colorInfo.style.display = 'none';
  } else {
    colorPicker.style.display = 'inline-block';
    colorInfo.style.display = 'inline-flex';
    updateColor(colorPicker.value);
  }
}
btnTransparent.addEventListener('click', ()=>applyBgSelection('transparent'));
btnPickColor.addEventListener('click', ()=>applyBgSelection('color'));

colorPicker.addEventListener('input', ()=>{
  updateColor(colorPicker.value);
});

function updateColor(hex){
  currentColor = hex;
  colorSwatch.style.background = hex;
  colorHex.textContent = hex.toUpperCase();
  colorInfo.style.display = 'inline-flex';
}

/* default: transparent */
applyBgSelection('transparent');

/* -------------------------
   Format buttons
   ------------------------- */
fmtButtons.forEach(b=>{
  b.addEventListener('click', ()=>{
    currentFormat = b.dataset.fmt;
    // toggle visual active state
    fmtButtons.forEach(x=>x.style.transform = 'scale(1)');
    b.style.transform = 'scale(0.98)'; // subtle press feedback
    setActiveFormatButton(currentFormat);
  });
});

/* -------------------------
   Resize Image -> draw to canvas
   ------------------------- */
btnResize.addEventListener('click', ()=>{
  if(!hasLoadedImage){
    alert('No image loaded. Please upload one or enter a URL and press Load.');
    return;
  }
  const w = Math.max(1, parseInt(widthInput.value) || originalImage.width || 300);
  const h = Math.max(1, parseInt(heightInput.value) || originalImage.height || 200);

  // set canvas size
  canvas.width = w;
  canvas.height = h;

  // set background
  if(currentBgFill === 'color'){
    ctx.fillStyle = currentColor || '#ffffff';
    ctx.fillRect(0,0,w,h);
  } else {
    // transparent -> clear canvas
    ctx.clearRect(0,0,w,h);
  }

  // draw image stretched to fit (you can change to cover/contain if needed)
  try {
    ctx.drawImage(originalImage, 0, 0, w, h);
  } catch(err){
    console.error('drawImage failed', err);
    alert('Unable to draw image on canvas (CORS or unsupported). Try another image or upload file.');
    return;
  }

  // determine mime type
  let mime = 'image/png';
  if(currentFormat === 'jpeg') mime = 'image/jpeg';
  if(currentFormat === 'gif'){
    // canvas.toDataURL('image/gif') is not widely supported — export as PNG but keep UI as GIF
    mime = 'image/gif';
  }
  if(currentFormat === 'webp'){
    mime = originalFormat || 'image/webp';
  }

  const dataURL = canvas.toDataURL(mime);
  preview.src = dataURL;

  // prepare download
  const ext = currentFormat === 'original' ? (originalFormat.split('/')[1] || 'png') : (currentFormat === 'gif' ? 'png' : currentFormat);
  downloadLink.href = dataURL;
  downloadLink.download = `Sirome_TV.${ext}`;
  downloadLink.style.display = 'inline-block';
  uploadBtn.style.display = 'inline-block';
  directLink.style.display = 'none';
});

/* -------------------------
   Reset Preview
   ------------------------- */
btnReset.addEventListener('click', resetPreview);
function resetPreview(){
  preview.src = 'https://i.postimg.cc/d1hHy4ss/11.png';
  canvas.width = canvas.height = 0;
  downloadLink.style.display = 'none';
  uploadBtn.style.display = 'none';
  directLink.style.display = 'none';
  hasLoadedImage = false;
}

/* -------------------------
   Upload to Postimages
   (keeps your original token + approach)
   ------------------------- */
uploadBtn.addEventListener('click', ()=>{
  if(!canvas.toBlob){
    alert('Your browser does not support canvas blob upload.');
    return;
  }
  canvas.toBlob(function(blob){
    const fd = new FormData();
    // NOTE: token is from your earlier code; keep using same approach
    fd.append('token','61aa06d6116f7331ad7b2ba9c7fb707ec9b182e8');
    fd.append('upload_session', 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa');
    fd.append('numfiles', '1');
    fd.append('upload_referer', 'https://getsharex.com/');
    fd.append('file', blob, 'image.png');

    // Post to postimg endpoint
    fetch('https://postimg.cc/json', { method:'POST', body:fd })
      .then(res=>res.json())
      .then(result=>{
        // API shape may vary; try common fields
        if(result && result.url){
          directLink.value = result.url;
          directLink.style.display = 'block';
          navigator.clipboard?.writeText(result.url).catch(()=>{});
          alert('Upload successful — direct link copied to clipboard (if allowed).');
          window.open(result.url,'_blank');
        } else if(result && result.image && result.image.display_url){
          // alternative shape
          directLink.value = result.image.display_url;
          directLink.style.display = 'block';
          navigator.clipboard?.writeText(result.image.display_url).catch(()=>{});
          alert('Upload successful — direct link copied.');
          window.open(result.image.display_url,'_blank');
        } else {
          console.log(result);
          alert('Upload failed or unexpected response. See console for details.');
        }
      })
      .catch(err=>{
        console.error('upload error', err);
        alert('Error uploading image. Check console for details.');
      });

  }, 'image/png');
});

/* -------------------------
   Utility: hide download/upload UI initially
   ------------------------- */
function hideDownloadUpload(){
  downloadLink.style.display = 'none';
  uploadBtn.style.display = 'none';
  directLink.style.display = 'none';
}
hideDownloadUpload();

/* -------------------------
   Accessibility tweaks: allow paste+enter to load URL
   ------------------------- */
urlInput.addEventListener('keydown', (e)=>{
  if(e.key === 'Enter') btnLoad.click();
});

/* -------------------------
   Initial preview already set to default image
   ------------------------- */
preview.addEventListener('error', ()=>{
  // fallback to default if preview fails
  preview.src = 'https://i.postimg.cc/d1hHy4ss/11.png';
});

</script>

<script>
    const btnClearUrl = document.getElementById('btnClearUrl');
if (btnClearUrl) {
  btnClearUrl.addEventListener('click', ()=> {
    urlInput.value = '';
    urlInput.focus();
  });
}


</script>


<script>
// Drag & Drop support
const dropZone = document.getElementById('dropZone');

dropZone.addEventListener('dragover', (e) => {
  e.preventDefault();
  dropZone.classList.add('dragover');
});
dropZone.addEventListener('dragleave', () => {
  dropZone.classList.remove('dragover');
});
dropZone.addEventListener('drop', (e) => {
  e.preventDefault();
  dropZone.classList.remove('dragover');
  const file = e.dataTransfer.files[0];
  if (file && file.type.startsWith('image/')) {
    const reader = new FileReader();
    reader.onload = (ev) => loadImage(ev.target.result);
    reader.readAsDataURL(file);
  } else {
    alert('Please drop a valid image file.');
  }
});

// Quick Sizes active highlight
qsButtons.forEach(btn => {
  btn.addEventListener('click', () => {
    qsButtons.forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
    widthInput.value = parseInt(btn.dataset.w);
    heightInput.value = parseInt(btn.dataset.h);
  });
});
</script>
<script>
// -------------- Paste Button (Clipboard থেকে URL পেস্ট) --------------
const btnPaste = document.getElementById('btnPaste');
btnPaste.addEventListener('click', async () => {
  try {
    const text = await navigator.clipboard.readText();
    if(text && text.startsWith('http')) {
      urlInput.value = text;
      loadImage(text); // Paste করার পরই ইমেজ লোড হয়ে যাবে
    } else {
      alert('Clipboard এ কোনো valid image URL নেই।');
    }
  } catch(err) {
    alert('Clipboard access অনুমোদিত নয়। ম্যানুয়ালি পেস্ট করুন।');
    console.error(err);
  }
});

// -------------- Clear Button (পুরো পেজ নতুন হবে) --------------
const btnClear = document.getElementById('btnClear');
btnClear.addEventListener('click', () => {
  window.location.reload(); // সম্পূর্ণ HTML নতুন করে লোড হবে
});
</script>
<script>
    // Click করলে ফাইল ডায়ালগ খুলবে
dropZone.addEventListener('click', () => {
  fileInput.click();
});
// কীবোর্ড (Enter/Space) সাপোর্ট
dropZone.addEventListener('keydown', (e) => {
  if (e.key === 'Enter' || e.key === ' ') {
    e.preventDefault();
    fileInput.click();
  }
});

</script>


</body>
</html>
